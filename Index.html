<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Handlebars — Members Panel</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- DaisyUI -->
  <link href="https://cdn.jsdelivr.net/npm/daisyui@2.20.0/dist/full.css" rel="stylesheet" />
  <!-- Handlebars -->
  <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.min.js"></script>

  <style>
    .admin-glow { 
      box-shadow: 0 0 25px rgba(0,255,220,0.35);
      border-color: rgba(0,255,220,0.6); 
    }
    body {
      background: linear-gradient(135deg, #1b0034, #12004a, #0a001a);
    }
  </style>
</head>

<body class="min-h-screen p-6 text-purple-100">
  <div class="max-w-4xl mx-auto">

    <div id="header-root"></div>

    <main class="mt-6">
      <div class="card bg-[#120028]/60 shadow-xl backdrop-blur-md p-4 border border-purple-700/40">

        <div class="flex gap-3 items-center justify-between">
          <div class="flex gap-3 items-center">

            <input id="search" placeholder="Search members..." 
              class="input input-bordered input-sm w-64 bg-[#1a0030] border-purple-600 text-purple-200" />

            <select id="roleFilter" 
              class="select select-sm select-bordered w-40 bg-[#1a0030] border-purple-600 text-purple-200">
              <option value="all">Show: All roles</option>
              <option value="admin">Admins only</option>
              <option value="user">Members only</option>
            </select>
          </div>

          <button id="refreshBtn" class="btn btn-sm bg-purple-700 hover:bg-purple-800 text-purple-100">Reload</button>
        </div>

        <section class="mt-4" id="users-root"></section>
      </div>
    </main>

    <footer class="mt-6 text-center text-xs text-purple-400/70">
      Tools used: TailwindCSS, Handlebars, JSON, DaisyUI — Neon UI Demo
    </footer>
  </div>

  <!-- Updated REAL JSON DATA -->
  <script id="users-data" type="application/json">
  [
    { "id": 101, "name": "Arjun Sharma", "email": "arjun.sharma@example.com", "role": "admin", "joined": "2022-08-17" },
    { "id": 102, "name": "Sneha Patel", "email": "sneha.patel@example.com", "role": "user", "joined": "2023-11-02" },
    { "id": 103, "name": "Rohit Verma", "email": "rohit.verma@example.com", "role": "user", "joined": "2024-04-11" },
    { "id": 104, "name": "Aisha Khan", "email": "aisha.khan@example.com", "role": "admin", "joined": "2021-12-03" },
    { "id": 105, "name": "Priya Menon", "email": "priya.menon@example.com", "role": "user", "joined": "2025-01-14" }
  ]
  </script>

  <!-- UPDATED HEADER (Only this changed) -->
  <script id="ph-header" type="text/x-handlebars-template">
    <header class="flex items-center gap-4">
      <div>
        <h1 class="text-xl font-bold text-cyan-300">Admin Panel</h1>
      </div>
    </header>
  </script>

  <script id="ph-usercard" type="text/x-handlebars-template">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
      {{#each users}}
        <article class="card card-compact bg-[#1a0030]/80 border border-purple-700/40 
          {{#isAdmin role}}admin-glow{{else}}border-purple-800{{/isAdmin}} p-3 backdrop-blur">
          
          <div class="card-body p-2">
            <div class="flex items-start justify-between gap-3">
              <div>
                <h3 class="font-semibold text-cyan-200">{{name}} <span class="text-xs text-purple-400">(#{{id}})</span></h3>
                <div class="text-sm text-purple-300">{{email}}</div>
                <div class="text-xs mt-2 text-purple-400">Joined: {{joined}}</div>
              </div>

              <div class="text-right">
                {{#isAdmin role}}
                  <div class="badge bg-cyan-500 text-black">ADMIN</div>
                {{else}}
                  <div class="badge bg-purple-700 text-purple-100">MEMBER</div>
                {{/isAdmin}}

                <div class="text-xs mt-2">Role: 
                  <span class="font-medium text-cyan-300">{{role}}</span>
                </div>
              </div>
            </div>
          </div>
        </article>
      {{/each}}
    </div>
  </script>

  <script id="app-template" type="text/x-handlebars-template">
    {{> header}}
    <section class="mt-4">
      {{> usercard users=users}}
    </section>
  </script>

  <!-- ======= APP LOGIC (unchanged) ======= -->
  <script>
    const users = JSON.parse(document.getElementById('users-data').textContent);

    function registerPartial(id, name) {
      const el = document.getElementById(id);
      if (!el) return;
      Handlebars.registerPartial(name, el.innerHTML);
    }
    registerPartial('ph-header', 'header');
    registerPartial('ph-usercard', 'usercard');

    Handlebars.registerHelper('isAdmin', function(role, options) {
      if (role === 'admin') {
        return options.fn(this);
      }
      return options.inverse(this);
    });

    const appSrc = document.getElementById('app-template').innerHTML;
    const appTpl = Handlebars.compile(appSrc);

    function render(filter = { q: '', role: 'all' }) {
      const q = filter.q.trim().toLowerCase();
      const role = filter.role;

      const filtered = users.filter(u => {
        const matchesQ = q === '' || (u.name + ' ' + u.email).toLowerCase().includes(q);
        const matchesRole = role === 'all' || u.role === role;
        return matchesQ && matchesRole;
      });

      const html = appTpl({ users: filtered });
      const headerHtml = Handlebars.compile(document.getElementById('ph-header').innerHTML)();

      document.getElementById('header-root').innerHTML = headerHtml;
      document.getElementById('users-root').innerHTML = html;
    }

    render();

    document.getElementById('search').addEventListener('input', (e) => {
      render({ q: e.target.value, role: document.getElementById('roleFilter').value });
    });

    document.getElementById('roleFilter').addEventListener('change', (e) => {
      render({ q: document.getElementById('search').value, role: e.target.value });
    });

    document.getElementById('refreshBtn').addEventListener('click', () => {
      render({ q: document.getElementById('search').value, role: document.getElementById('roleFilter').value });
    });
  </script>
</body>
</html>
